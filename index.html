<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Quiz Game</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
<!-- Firebase App (compat version) -->
<script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-app-compat.js"></script>
<!-- Firestore (compat version) -->
<script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-firestore-compat.js"></script>

  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
    import { getFirestore, collection, addDoc } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

    // Replace with your Firebase config
    const firebaseConfig = {
      apiKey: "AIzaSyCv6nPwgzTl7qDNSZ1MkpoGAOHyxpkKL4s",
		authDomain: "quizapp-cf724.firebaseapp.com",
		databaseURL: "https://quizapp-cf724-default-rtdb.asia-southeast1.firebasedatabase.app",
		projectId: "quizapp-cf724",
		storageBucket: "quizapp-cf724.firebasestorage.app",
		messagingSenderId: "948696897116",
		appId: "1:948696897116:web:8d8bf48e0b818ace0ef899",
		measurementId: "G-MLNBNFC70Y"
    };

    // Initialize Firebase
  firebase.initializeApp(firebaseConfig);

  // Initialize Firestore
  const db = firebase.firestore();



    let tableNumber = null;
    let currentQuestion = null;

    const answers = {
      1: "FOOD POVERTY",
      2: "DHA",
      3: "BRAIN",
      4: "SYNAPTOGENESIS",
      5: "DHASURV"
    };
	
	const questions = [
	"1.This is the condition of not having access to sufficient food, or food of an adequate quality, to meet one's basic needs.",
	"2. Which omega-3 fatty acid is critical for brain development?",
	"3. Aside from the retina, where can we find the highest concentration of docosahexaenoic acid (DHA) in the body?",
	"4. What process refers to the formation of the crucial junction where a neuron communicates with another cell?",
	"5. Complete the sentence: With Lactum 3+, we can help give the Filipino children the DHA they ________!"
	];


    window.setTable = function() {
      tableNumber = document.getElementById("tableNumber").value;
      if (!tableNumber) { alert("Enter table number!"); return; }
      document.getElementById("setup").style.display = "none";
      document.getElementById("questions").style.display = "block";
    }

    window.showQuestion = function(num) {
  currentQuestion = num;
  document.querySelector(".question-text").textContent = questions[currentQuestion - 1];

  document.getElementById("questions").style.display = "none";
  document.getElementById("game").style.display = "block";

  const correctAnswer = answers[num];
  const scrambled = correctAnswer.split("").sort(() => Math.random() - 0.5);

  const container = document.getElementById("scrambleText");
  container.innerHTML = "";
  scrambled.forEach(letter => {
    const span = document.createElement("span");
    span.textContent = letter;
    span.className = "scramble-letter";
    container.appendChild(span);
  });

  document.getElementById("answerBox").value = "";
}

window.sendData = async function() {
  const userAnswer = document.getElementById("answerBox").value
    .trim()
    .toUpperCase()
    .replace(/\s+/g, "");

  const correctAnswer = answers[currentQuestion]
    .toUpperCase()
    .replace(/\s+/g, "");

  if (userAnswer !== correctAnswer) {
    alert("Answer is wrong! Please try again.");
    return;
  }

  alert("Correct! Answer submitted.");

  try {
    await db.collection("submissions").add({
      tableNumber: tableNumber,
      questionNumber: currentQuestion,
      timestamp: firebase.firestore.Timestamp.now()
    });
    document.getElementById("game").style.display = "none";
    document.getElementById("questions").style.display = "block";
  } catch (e) {
    console.error(e);
    alert("Error submitting to server, but your answer was correct.");
  }
};

    window.closePopup = function() {
      document.getElementById("popup").style.display = "none";
    }
	
	window.goBack = function() {
  document.getElementById("game").style.display = "none";
  document.getElementById("questions").style.display = "block";
  document.getElementById("answerBox").value = "";
	}
	
	// Attach listener once the page loads
window.onload = function() {
  const answerBox = document.getElementById("answerBox");
  answerBox.addEventListener("keydown", function(event) {
    if (event.key === "Enter") {
      event.preventDefault(); // prevent form submission refresh
      sendData();             // call the same function as SEND button
    }
  });
};




  </script>
  <style>
  html, body {
  height: 100%;              /* stretch to full viewport */
  margin: 0;
  padding: 0;
}


body {
  min-height: 100vh;          /* always at least full screen height */
  background: linear-gradient(to bottom, lightblue, darkblue);
  background-repeat: no-repeat; /* stop tiling */
  background-attachment: fixed; /* lock gradient to viewport */
  background-size: cover;       /* stretch gradient to cover entire screen */
  display: flex;
  flex-direction: column;
  align-items: center;
  font-family: 'Inter', sans-serif;
  margin: 0;
  padding: 20px;
  text-align: center;
  min-height: 100vh;
  color: white;

}

	
	
    .logo {
		width: 120px;       /* control width */
		height: auto;       /* let height adjust naturally */
		margin-bottom: 20px;
	}

    input, textarea {
      width: 90%;
      max-width: 400px;
      padding: 10px;
      margin: 10px 0;
      font-size: 16px;
    }
    button {
  font-size: 1.2em;       /* scales with screen */
  padding: 10px 20px;
  margin: 10px;
  border: none;
  border-radius: 8px;
  background-color: red;
  color: white;
  font-weight: bold;
}

    button:hover {
      opacity: 0.85;
    }
    #popup {
      display:none;
      position:fixed;
      top:50%; left:50%;
      transform:translate(-50%,-50%);
      background:white;
      border:2px solid black;
      padding:20px;
      text-align:center;
    }
    img {
      max-width: 90%;
      height: auto;
      margin: 15px 0;
    }
	
	#scrambleText {
	margin: 20px 0;
	text-align: center;
	}

	.scramble-letter {
  display: inline-block;
  font-size: 32px;
  font-weight: bold;
  color: white; /* fill stays visible */
  text-shadow: 
    -2px -2px 0 black,
     2px -2px 0 black,
    -2px  2px 0 black,
     2px  2px 0 black; /* outline effect */
  margin: 5px;
}
	
	.popup {
  display: none;
  position: fixed;
  top: 50%; left: 50%;
  transform: translate(-50%, -50%);
  background: white;
  border: 2px solid black;
  padding: 20px;
  text-align: center;
  z-index: 1000;
	}

  .question-title {
  text-align: center;
  font-weight: bold;
  color: white;
  font-size: 20px;
  margin-bottom: 15px;
  }
  
  #answerBox {
  font-size: 1.2em;
  padding: 8px;
  width: 80%;            /* responsive width */
  max-width: 400px;
  margin: 15px auto;
  display: block;
}

.version-text {
  position: fixed;       /* stays in place */
  bottom: 5px;           /* near the bottom edge */
  left: 50%;             /* center horizontally */
  transform: translateX(-50%); /* true centering */
  font-size: 10px;       /* tiny text */
  font-weight: bold;     /* readable */
  color: white;          /* matches your theme */
  opacity: 0.8;          /* subtle but visible */
  margin: 0;
}

.question-text {
  font-size: 18px;        /* readable size */
  font-weight: bold;      /* emphasis */
  color: white;           /* matches your theme */
  text-align: center;     /* centered above letters */
  margin-bottom: 15px;    /* spacing before scrambled letters */
}


  </style>
</head>
<body>

  <!-- Logo always on top -->
  <img src="logo.png" alt="Logo" class="logo">

  <!-- Setup -->
  <div id="setup">
    <input id="tableNumber" placeholder="Enter table number"> <br>
    <button onclick="setTable()">Next</button>
  </div>

<!-- Questions -->
<div id="questions" style="display:none;">
  <p class="question-title">Select a question:</p>
  <button onclick="showQuestion(1)">Q1</button> <br>
  <button onclick="showQuestion(2)">Q2</button> <br>
  <button onclick="showQuestion(3)">Q3</button> <br>
  <button onclick="showQuestion(4)">Q4</button> <br>
  <button onclick="showQuestion(5)">Q5</button> <br>
</div>


<!-- Game -->
<div id="game" style="display:none;">
  <div id="questionArea">
  <p class="question-text">Question will appear here</p>
  </div><br>
  <div id="scrambleText"></div> <br>
  <input id="answerBox" type="text" placeholder="Type your answer here"> <br>
  <button onclick="sendData()">SEND</button> <br>
  <button onclick="goBack()">Back to Questions</button> <br>
</div>

<p class="version-text">v3</p>

</body>
</html>